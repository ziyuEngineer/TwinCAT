///////////////////////////////////////////////////////////////////////////////
// MotionControlServices.h

#pragma once

#include "TcServices.h"

const ULONG DrvID_MotionControl = 0x3F000000;
#define SRVNAME_MOTIONCONTROL "MotionControl"

///<AutoGeneratedContent id="ClassIDs">
const CTCID CID_MotionControlCMotionControl = {0x73d79b9f,0xfc12,0x4c59,{0x97,0x3c,0x7e,0x93,0x7a,0x98,0x2d,0xda}};
///</AutoGeneratedContent>

///<AutoGeneratedContent id="ParameterIDs">
const PTCID PID_MotionControlParameter = 0x00000001;
const PTCID PID_MotionControlPLC_SoEProcess = 0x00000002;
const PTCID PID_MotionControlPLC_PanelProcess = 0x00000003;
///</AutoGeneratedContent>

///<AutoGeneratedContent id="DataTypes">
#if !defined(_TC_TYPE_54E74FBE_0A82_440E_8829_BF368D27C93C_INCLUDED_)
#define _TC_TYPE_54E74FBE_0A82_440E_8829_BF368D27C93C_INCLUDED_
typedef struct _MotionCommand
{
	double pos[5];
	double vel[5];
	double acc[5];
	double kp[5];
	double kv[5];
	double ka[5];
	SHORT opMode[5];
	unsigned char reserved1[2];
	ULONG commandIndex;
} MotionCommand, *PMotionCommand;
#endif // !defined(_TC_TYPE_54E74FBE_0A82_440E_8829_BF368D27C93C_INCLUDED_)

#if !defined(_TC_TYPE_F512F522_E8D1_4D42_8E2E_F11B4CC4AE58_INCLUDED_)
#define _TC_TYPE_F512F522_E8D1_4D42_8E2E_F11B4CC4AE58_INCLUDED_
typedef struct _MotionControlInfo
{
	SHORT AbsEncDir;
	unsigned char reserved1[2];
	LONG AbsEncRes;
	double RatedCurrent;
	double RatedTorque;
	SHORT TorDir;
	unsigned char reserved2[2];
	LONG AbsZeroPos;
	LONG PosUpperLimit;
	LONG PosLowerLimit;
	double TransmissionRatio;
	SHORT TorPdoMax;
	SHORT AdditiveTorque;
	bool AbsEncType;
	unsigned char reserved3;
	SHORT PositiveHardBit;
	SHORT NegativeHardBit;
	SHORT DriverType;
	bool Exposed;
	unsigned char reserved4[3];
} MotionControlInfo, *PMotionControlInfo;
#endif // !defined(_TC_TYPE_F512F522_E8D1_4D42_8E2E_F11B4CC4AE58_INCLUDED_)

#if !defined(_TC_TYPE_91114EB3_9644_4864_867E_7C4ACBF08BE8_INCLUDED_)
#define _TC_TYPE_91114EB3_9644_4864_867E_7C4ACBF08BE8_INCLUDED_
typedef struct _DriverInput
{
	USHORT StatusWord;
	unsigned char reserved1[2];
	LONG ActualAbsPos;
	SHORT ActualTor;
	unsigned char reserved2[2];
	LONG ActualVel;
	SHORT ErrorCode;
	SHORT WarningCode;
	SHORT DigitalInput_1;
	char ActualOpMode;
	unsigned char reserved3;
} DriverInput, *PDriverInput;
#endif // !defined(_TC_TYPE_91114EB3_9644_4864_867E_7C4ACBF08BE8_INCLUDED_)

#if !defined(_TC_TYPE_B4A9A927_0308_4BB0_8808_D7AD02AF7FD9_INCLUDED_)
#define _TC_TYPE_B4A9A927_0308_4BB0_8808_D7AD02AF7FD9_INCLUDED_
typedef struct _DriverOutput
{
	USHORT ControlWord;
	unsigned char reserved1[2];
	LONG TargetPosition;
	SHORT TargetTorque;
	unsigned char reserved2[2];
	LONG TargetVelocity;
	char OperationMode;
	unsigned char reserved3[3];
} DriverOutput, *PDriverOutput;
#endif // !defined(_TC_TYPE_B4A9A927_0308_4BB0_8808_D7AD02AF7FD9_INCLUDED_)

#if !defined(_TC_TYPE_131977EF_E050_44EA_B063_7A4112666AE9_INCLUDED_)
#define _TC_TYPE_131977EF_E050_44EA_B063_7A4112666AE9_INCLUDED_
enum SystemState : SHORT {
	eIdle = 0,
	eInitialization = 1,
	eDisabled = 2,
	eStandby = 3,
	eMoving = 4,
	eHandwheel = 5,
	eLimitViolation = 6,
	eFault = 7,
	eEmergency = 8,
	eTest = 9,
	eRecovery = 10
};
#endif // !defined(_TC_TYPE_131977EF_E050_44EA_B063_7A4112666AE9_INCLUDED_)

#if !defined(_TC_TYPE_13C5ED93_554D_47D2_9A08_D46CC349EDDD_INCLUDED_)
#define _TC_TYPE_13C5ED93_554D_47D2_9A08_D46CC349EDDD_INCLUDED_
typedef struct _PanelInfo
{
	bool ServoOn;
	unsigned char reserved1;
	SHORT Handwheel_EnabledAxisNum;
	unsigned char reserved2[4];
	double Handwheel_Ratio;
	double Handwheel_dPos[5];
	SHORT Spindle_Cmd;
	bool Reset;
	bool Execute;
	unsigned char reserved3[4];
} PanelInfo, *PPanelInfo;
#endif // !defined(_TC_TYPE_13C5ED93_554D_47D2_9A08_D46CC349EDDD_INCLUDED_)

#if !defined(_TC_TYPE_75816603_8B01_41ED_9F49_1001E13236B1_INCLUDED_)
#define _TC_TYPE_75816603_8B01_41ED_9F49_1001E13236B1_INCLUDED_
enum OpMode : SHORT {
	CSP = 8,
	CSV = 9,
	CST = 10
};
#endif // !defined(_TC_TYPE_75816603_8B01_41ED_9F49_1001E13236B1_INCLUDED_)

#if !defined(_TC_TYPE_760AEB87_AF7B_4178_B0AF_C2E7472652E4_INCLUDED_)
#define _TC_TYPE_760AEB87_AF7B_4178_B0AF_C2E7472652E4_INCLUDED_
enum DriverState : USHORT {
	eNotReadyForPowerUp = 0,
	eShutDownError = 40960,
	eLogicReadyForPowerOn = 16384,
	ePowerStageLocked = 32768,
	eReadyToOperate = 49152
};
#endif // !defined(_TC_TYPE_760AEB87_AF7B_4178_B0AF_C2E7472652E4_INCLUDED_)

#if !defined(_TC_TYPE_8A0CBD64_A622_4812_96E8_6466F6FAD96D_INCLUDED_)
#define _TC_TYPE_8A0CBD64_A622_4812_96E8_6466F6FAD96D_INCLUDED_
enum MasterControlWord : USHORT {
	eHaltDrive = 0,
	eStopDrive = 1,
	eControlUnitSync = 1024,
	eRestartDrive = 8192,
	eDriveOff = 24576,
	eDriveOn_CSP = 57344,
	eDriveOn_CST = 57600,
	eDriveOn_CSV = 57856
};
#endif // !defined(_TC_TYPE_8A0CBD64_A622_4812_96E8_6466F6FAD96D_INCLUDED_)

#if !defined(_TC_TYPE_4CC52115_110B_4A46_936A_8C0B97DF661E_INCLUDED_)
#define _TC_TYPE_4CC52115_110B_4A46_936A_8C0B97DF661E_INCLUDED_
enum AxisOrder : SHORT {
	Axis_X = 1,
	Axis_Y = 2,
	Axis_Z = 3,
	Axis_A = 4,
	Axis_C = 5
};
#endif // !defined(_TC_TYPE_4CC52115_110B_4A46_936A_8C0B97DF661E_INCLUDED_)

#if !defined(_TC_TYPE_30A75C5D_E2C3_49AB_A295_5F256B553724_INCLUDED_)
#define _TC_TYPE_30A75C5D_E2C3_49AB_A295_5F256B553724_INCLUDED_
typedef struct _AxisInformation
{
	double CurrentPos;
	double CurrentVel;
	SHORT CurrentTor;
	unsigned char CurrentMode;
	unsigned char reserved1[5];
	double CommandPos;
	double CommandVel;
	SHORT CommandTor;
	unsigned char reserved2[6];
} AxisInformation, *PAxisInformation;
#endif // !defined(_TC_TYPE_30A75C5D_E2C3_49AB_A295_5F256B553724_INCLUDED_)

#if !defined(_TC_TYPE_8A554618_FB22_4EDD_9FCF_D053B7A70EC0_INCLUDED_)
#define _TC_TYPE_8A554618_FB22_4EDD_9FCF_D053B7A70EC0_INCLUDED_
typedef struct _InterpolationParameter
{
	double MaxVelocity;
	double MaxAcceleration;
	double MaxJerk;
	double CycleTime;
	double Tolerance;
} InterpolationParameter, *PInterpolationParameter;
#endif // !defined(_TC_TYPE_8A554618_FB22_4EDD_9FCF_D053B7A70EC0_INCLUDED_)

#if !defined(_TC_TYPE_B0C94ECF_2C99_4196_87CB_D77C19F16C25_INCLUDED_)
#define _TC_TYPE_B0C94ECF_2C99_4196_87CB_D77C19F16C25_INCLUDED_
enum ControlWord_General : SHORT {
	eDisableVoltage = 0,
	eQuickStop = 2,
	eShutdown = 6,
	eDisableOperation = 7,
	eSwitchOn = 7,
	eEnableOperation = 15,
	eFaultReset = 128
};
#endif // !defined(_TC_TYPE_B0C94ECF_2C99_4196_87CB_D77C19F16C25_INCLUDED_)

#if !defined(_TC_TYPE_09FBE7F9_69A6_4823_ACE3_891F5EA25396_INCLUDED_)
#define _TC_TYPE_09FBE7F9_69A6_4823_ACE3_891F5EA25396_INCLUDED_
enum DriverState_General : SHORT {
	eNotReadyToSwitchOn = 0,
	eSwitchOnDisabled = 64,
	eReadyToSwitchOn = 33,
	eSwitchedOn = 35,
	eOperationEnabled = 39,
	eQuickStopActive = 7,
	eFaultReactionActive = 15,
	eDriverFault = 8,
	eQuickStopBit = 32
};
#endif // !defined(_TC_TYPE_09FBE7F9_69A6_4823_ACE3_891F5EA25396_INCLUDED_)

#if !defined(_TC_TYPE_6C52FF3C_3F1E_4DF4_B88E_56EAE4037B12_INCLUDED_)
#define _TC_TYPE_6C52FF3C_3F1E_4DF4_B88E_56EAE4037B12_INCLUDED_
typedef struct _MetaData
{
	unsigned char CommandType;
	unsigned char reserved1[3];
	ULONG SourceActionBlockIndex;
	ULONG Index;
} MetaData, *PMetaData;
#endif // !defined(_TC_TYPE_6C52FF3C_3F1E_4DF4_B88E_56EAE4037B12_INCLUDED_)

#if !defined(_TC_TYPE_CD793B8A_BCC8_462B_A724_63EDD950FD54_INCLUDED_)
#define _TC_TYPE_CD793B8A_BCC8_462B_A724_63EDD950FD54_INCLUDED_
typedef struct _NewMotionCommand
{
	unsigned char MotionType[5];
	unsigned char reserved1[3];
	double Pos[5];
	double Vel[5];
	double Acc[5];
	double Kp[5][5];
	double Kv[5][5];
	double Ka[5][5];
} NewMotionCommand, *PNewMotionCommand;
#endif // !defined(_TC_TYPE_CD793B8A_BCC8_462B_A724_63EDD950FD54_INCLUDED_)

#if !defined(_TC_TYPE_0C8C736F_2009_4A9B_BA79_A373A15B7252_INCLUDED_)
#define _TC_TYPE_0C8C736F_2009_4A9B_BA79_A373A15B7252_INCLUDED_
typedef struct _OtherCommand
{
	ULONG CommandFunction;
	unsigned char reserved1[4];
	double Data;
} OtherCommand, *POtherCommand;
#endif // !defined(_TC_TYPE_0C8C736F_2009_4A9B_BA79_A373A15B7252_INCLUDED_)

#if !defined(_TC_TYPE_DA968A32_D27D_4418_BD17_1BA7D385549F_INCLUDED_)
#define _TC_TYPE_DA968A32_D27D_4418_BD17_1BA7D385549F_INCLUDED_
typedef struct _FullCommand
{
	MetaData Meta_Data;
	unsigned char reserved1[4];
	NewMotionCommand Motion_Command;
	OtherCommand Other_Command;
} FullCommand, *PFullCommand;
#endif // !defined(_TC_TYPE_DA968A32_D27D_4418_BD17_1BA7D385549F_INCLUDED_)

#if !defined(_TC_TYPE_B25F8E0A_8174_4882_B713_311192F6B289_INCLUDED_)
#define _TC_TYPE_B25F8E0A_8174_4882_B713_311192F6B289_INCLUDED_
enum CommandType : SHORT {
	eMotion = 1,
	eOther = 4,
	eSignalFinalized = 5,
	eNone = 0
};
#endif // !defined(_TC_TYPE_B25F8E0A_8174_4882_B713_311192F6B289_INCLUDED_)

typedef struct _MotionControlParameter
{
	MotionControlInfo DriverParameter[10];
	MotionControlInfo SpindleDriverParam;
	InterpolationParameter AxisGroupInterpolationParam[10];
	InterpolationParameter SpindleInterpolationParam;
} MotionControlParameter, *PMotionControlParameter;

typedef struct _MotionControlInputs
{
	DriverInput AxisInputs[10];
	PanelInfo PanelInformation;
	bool mockButton[10];
	unsigned char reserved1[6];
	double TestInputs[20];
	DriverInput SpindleInput;
	FullCommand CommandInput[1024];
	ULONG CommandWriteIndex;
	OTCID OidSoEProcess;
	OTCID OidPanelProcess;
	unsigned char reserved2[4];
} MotionControlInputs, *PMotionControlInputs;

typedef struct _MotionControlOutputs
{
	DriverOutput AxisOutputs[10];
	struct {
		SystemState AxisGroupState;
		SystemState SpindleState;
	} SystemStateMachine;
	unsigned char reserved1[4];
	struct {
		AxisInformation AxisStatus[6];
		double GantryDeviation;
	} AxisInfo;
	DriverOutput SpindleOutput;
	ULONG CommandReadIndex;
	FullCommand TestAxisGroup;
	FullCommand TestSpindle;
} MotionControlOutputs, *PMotionControlOutputs;

///</AutoGeneratedContent>



///<AutoGeneratedContent id="DataAreaIDs">
#define ADI_MotionControlInputs 0
#define ADI_MotionControlOutputs 1
///</AutoGeneratedContent>

///<AutoGeneratedContent id="InterfaceIDs">
#if !defined(_TC_IID_75F6F238_A022_446E_8F56_58206FCA8931_INCLUDED_)
#define _TC_IID_75F6F238_A022_446E_8F56_58206FCA8931_INCLUDED_
TCOM_DECL_INTERFACE("75f6f238-a022-446e-8f56-58206fca8931", InterfaceRPC)
#endif // !defined(_TC_IID_75F6F238_A022_446E_8F56_58206FCA8931_INCLUDED_)

#if !defined(_TC_IID_970DA61A_269B_41C3_8941_02F0458E1BF8_INCLUDED_)
#define _TC_IID_970DA61A_269B_41C3_8941_02F0458E1BF8_INCLUDED_
TCOM_DECL_INTERFACE("970da61a-269b-41c3-8941-02f0458e1bf8", ISoEProcess)
#endif // !defined(_TC_IID_970DA61A_269B_41C3_8941_02F0458E1BF8_INCLUDED_)

#if !defined(_TC_IID_BAA6EC0B_E089_4261_B526_D49D4945A12E_INCLUDED_)
#define _TC_IID_BAA6EC0B_E089_4261_B526_D49D4945A12E_INCLUDED_
TCOM_DECL_INTERFACE("baa6ec0b-e089-4261-b526-d49d4945a12e", IPanelProcess)
#endif // !defined(_TC_IID_BAA6EC0B_E089_4261_B526_D49D4945A12E_INCLUDED_)

///</AutoGeneratedContent>

///<AutoGeneratedContent id="EventClasses">
///</AutoGeneratedContent>
